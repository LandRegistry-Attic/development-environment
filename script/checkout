#!/bin/bash

function update_development_environment {
  echo "Updating development environment"
  git -C /vagrant pull 
  lr-bootstrap
}

function checkout {
  app=$1
 
  if [[ ! -d /vagrant/apps/${app} ]] ; then 
    mkdir -p /vagrant/apps/
    git -C /vagrant/apps/ clone git@github.com:landregistry/${app}.git

    if [[ -f /vagrant/apps/${app}/.gitmodules ]] ; then
      echo "Initialising git submodule for ${app}"
      git -C /vagrant/apps/${app} submodule init
      git -C /vagrant/apps/${app} submodule update
    fi
  fi
}

function update_app {
  app=$1
    
  if [ -d /vagrant/apps/${app} ] ; then
    echo "Refreshing application ${app}"
    git -C /vagrant/apps/${app} pull
    
    if [[ -f /vagrant/apps/${app}/.gitmodules ]] ; then
      echo "Initialising git submodule for ${app}"
      git -C /vagrant/apps/${app} submodule init
      git -C /vagrant/apps/${app} submodule update
    fi
  fi
}